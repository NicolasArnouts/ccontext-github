nohup: ignoring input
[2024-09-22 21:49:54] Pulling latest changes from git...
From https://github.com/NicolasArnoutsHoGent/ccontext-github
 * branch            main       -> FETCH_HEAD
hint: You have divergent branches and need to specify how to reconcile them.
hint: You can do so by running one of the following commands sometime before
hint: your next pull:
hint: 
hint:   git config pull.rebase false  # merge
hint:   git config pull.rebase true   # rebase
hint:   git config pull.ff only       # fast-forward only
hint: 
hint: You can replace "git config" with "git config --global" to set a default
hint: preference for all repositories. You can also pass --rebase, --no-rebase,
hint: or --ff-only on the command line to override the configured default per
hint: invocation.
fatal: Need to specify how to reconcile divergent branches.
[2024-09-22 21:49:54] Failed to pull latest changes
nohup: ignoring input
[2024-09-22 21:51:10] Pulling latest changes from git...
From https://github.com/NicolasArnoutsHoGent/ccontext-github
 * branch            dev        -> FETCH_HEAD
Already up to date.
[2024-09-22 21:51:11] Stopping running containers...
[2024-09-22 21:51:11] Building new Docker images...
#0 building with "default" instance using docker driver

#1 [app internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.11kB done
#1 DONE 0.0s

#2 [app internal] load metadata for docker.io/library/node:20-alpine
#2 DONE 0.7s

#3 [app  1/15] FROM docker.io/library/node:20-alpine@sha256:2d07db07a2df6830718ae2a47db6fedce6745f5bcd174c398f2acdda90a11c03
#3 DONE 0.0s

#4 [app internal] load .dockerignore
#4 transferring context: 163B done
#4 DONE 0.0s

#5 [app internal] load build context
#5 transferring context: 9.56kB 0.0s done
#5 DONE 0.1s

#6 [app  7/15] COPY .env ./
#6 CACHED

#7 [app  8/15] RUN npm ci
#7 9.090 npm warn deprecated rimraf@3.0.2: Rimraf versions prior to v4 are no longer supported
#7 12.07 npm warn deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.
#7 15.75 npm warn deprecated @humanwhocodes/object-schema@2.0.3: Use @eslint/object-schema instead
#7 15.75 npm warn deprecated @humanwhocodes/config-array@0.11.14: Use @eslint/config-array instead
#7 16.14 npm warn deprecated @aws-sdk/signature-v4@3.374.0: This package has moved to @smithy/signature-v4
#7 16.14 npm warn deprecated @aws-sdk/protocol-http@3.374.0: This package has moved to @smithy/protocol-http
#7 17.97 npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported
#7 49.46 
#7 49.46 > ccontext-github@0.2.0 postinstall
#7 49.46 > prisma generate
#7 49.46 
#7 50.81 Environment variables loaded from .env
#7 50.81 Prisma schema loaded from prisma/schema.prisma
#7 52.20 
#7 52.20 ✔ Generated Prisma Client (v5.19.0) to ./node_modules/@prisma/client in 263ms
#7 52.20 
#7 52.20 Start by importing your Prisma Client (See: http://pris.ly/d/importing-client)
#7 52.20 
#7 52.20 Tip: Curious about the SQL queries Prisma ORM generates? Optimize helps you enhance your visibility: https://pris.ly/tip-2-optimize
#7 52.20 
#7 52.39 
#7 52.39 added 922 packages, and audited 923 packages in 52s
#7 52.40 
#7 52.40 287 packages are looking for funding
#7 52.40   run `npm fund` for details
#7 52.52 
#7 52.52 3 high severity vulnerabilities
#7 52.52 
#7 52.52 To address issues that do not require attention, run:
#7 52.52   npm audit fix
#7 52.52 
#7 52.52 To address all issues, run:
#7 52.52   npm audit fix --force
#7 52.52 
#7 52.52 Run `npm audit` for details.
#7 52.52 npm notice
#7 52.52 npm notice New patch version of npm available! 10.8.2 -> 10.8.3
#7 52.52 npm notice Changelog: https://github.com/npm/cli/releases/tag/v10.8.3
#7 52.52 npm notice To update run: npm install -g npm@10.8.3
#7 52.52 npm notice
#7 DONE 52.9s

#8 [app  8/15] RUN npm ci
#8 CACHED

#9 [app  2/15] RUN apk add --no-cache     python3     py3-pip     git     libc6-compat     make     g++     nano
#9 CACHED

#10 [app  3/15] WORKDIR /app
#10 CACHED

#11 [app  5/15] COPY package*.json ./
#11 CACHED

#12 [app  4/15] RUN pip install ccontext --break-system-packages
#12 CACHED

#13 [app  6/15] COPY prisma ./prisma/
#13 CACHED

#14 [app  7/15] COPY .env ./
#14 CACHED

#15 [app  9/15] COPY . .
#15 DONE 0.2s

#16 [app 10/15] RUN npx prisma generate
#16 3.084 Environment variables loaded from .env
#16 3.106 Prisma schema loaded from prisma/schema.prisma
#16 4.681 
#16 4.681 ✔ Generated Prisma Client (v5.19.0) to ./node_modules/@prisma/client in 310ms
#16 4.681 
#16 4.681 Start by importing your Prisma Client (See: http://pris.ly/d/importing-client)
#16 4.681 
#16 4.681 Tip: Interested in query caching in just a few lines of code? Try Accelerate today! https://pris.ly/tip-3-accelerate
#16 4.681 
#16 DONE 4.9s

#17 [app 11/15] RUN npm run build
#17 0.670 
#17 0.670 > ccontext-github@0.2.0 build
#17 0.670 > next build
#17 0.670 
#17 2.191 Attention: Next.js now collects completely anonymous telemetry regarding usage.
#17 2.194 This information is used to shape Next.js' roadmap and prioritize features.
#17 2.194 You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:
#17 2.194 https://nextjs.org/telemetry
#17 2.194 
#17 2.396   ▲ Next.js 14.2.5
#17 2.397   - Environments: .env
#17 2.397   - Experiments (use with caution):
#17 2.397     · outputFileTracingRoot
#17 2.397 
#17 2.612    Creating an optimized production build ...
#17 59.63  ⚠ Compiled with warnings
#17 59.63 
#17 59.63 ./node_modules/token.js/dist/index.cjs
#17 59.63 Module not found: Can't resolve 'encoding' in '/app/node_modules/token.js/dist'
#17 59.63 
#17 59.63 Import trace for requested module:
#17 59.63 ./node_modules/token.js/dist/index.cjs
#17 59.63 ./app/api/chat/route.ts
#17 59.63 
#17 108.6  ✓ Compiled successfully
#17 108.6    Skipping linting
#17 108.6    Checking validity of types ...
#17 128.7    Collecting page data ...
#17 134.9    Generating static pages (0/18) ...
#17 136.8    Generating static pages (4/18) 
#17 138.2    Generating static pages (8/18) 
#17 138.4 prisma:query BEGIN
#17 138.4 prisma:query DEALLOCATE ALL
#17 138.4 prisma:query SELECT "public"."Model"."id", "public"."Model"."name", "public"."Model"."provider", "public"."Model"."tags", "public"."Model"."pricePerMillionTokens", "public"."Model"."initialTokens", "public"."Model"."resetTokens" FROM "public"."Model" WHERE 1=1 OFFSET $1
#17 138.4 prisma:query COMMIT
#17 138.7    Generating static pages (13/18) 
#17 141.0  ✓ Generating static pages (18/18)
#17 141.9    Finalizing page optimization ...
#17 141.9    Collecting build traces ...
#17 165.6 
#17 165.6 Route (app)                              Size     First Load JS
#17 165.6 ┌ ƒ /                                    2.6 MB          2.7 MB
#17 165.6 ├ ƒ /_not-found                          871 B          88.4 kB
#17 165.6 ├ ƒ /api/add-tokens                      0 B                0 B
#17 165.6 ├ ƒ /api/ccontext-result                 0 B                0 B
#17 165.6 ├ ƒ /api/chat                            0 B                0 B
#17 165.6 ├ ƒ /api/clone                           0 B                0 B
#17 165.6 ├ ƒ /api/create-checkout-session         0 B                0 B
#17 165.6 ├ ƒ /api/download-pdf                    0 B                0 B
#17 165.6 ├ ○ /api/models                          0 B                0 B
#17 165.6 ├ ƒ /api/run-ccontext                    0 B                0 B
#17 165.6 ├ ƒ /api/save-message                    0 B                0 B
#17 165.6 ├ ƒ /api/token-tracking                  0 B                0 B
#17 165.6 ├ ƒ /api/user-info                       0 B                0 B
#17 165.6 ├ ƒ /api/webhook                         0 B                0 B
#17 165.6 └ ƒ /token-store                         10.5 kB         144 kB
#17 165.6 + First Load JS shared by all            87.6 kB
#17 165.6   ├ chunks/23-f7c21c06cb8fe3d3.js        31.4 kB
#17 165.6   ├ chunks/fd9d1056-e938691580ea38ac.js  53.6 kB
#17 165.6   └ other shared chunks (total)          2.48 kB
#17 165.6 
#17 165.6 
#17 165.6 ƒ Middleware                             58 kB
#17 165.6 
#17 165.6 ○  (Static)   prerendered as static content
#17 165.6 ƒ  (Dynamic)  server-rendered on demand
#17 165.6 
#17 DONE 165.8s

#18 [app 12/15] RUN addgroup -g 1001 -S nodejs
#18 DONE 0.4s

#19 [app 13/15] RUN adduser -S nextjs -u 1001
#19 DONE 0.4s

#20 [app 14/15] RUN chown -R nextjs:nodejs /app
#20 DONE 273.6s

#21 [app 15/15] RUN mkdir -p /app/temp_environments && chown nextjs:nodejs /app/temp_environments
#21 DONE 0.3s

#22 [app] exporting to image
#22 exporting layers
#22 exporting layers 25.7s done
#22 writing image sha256:1b6b9a0dfa81f7212c9158b7311a6437b3906f0db6a7bda4ecd36f3f557c8ed1 done
#22 naming to docker.io/library/ccontext-github-app 0.0s done
#22 DONE 25.8s

#23 [app] resolving provenance for metadata file
#23 DONE 0.0s
[2024-09-22 21:59:04] Starting new containers...
 Network ccontext-github_app-network  Creating
 Network ccontext-github_app-network  Created
 Container ccontext-github-app-1  Creating
 Container ccontext-github-app-1  Created
 Container ccontext-github-app-1  Starting
 Container ccontext-github-app-1  Started
[2024-09-22 21:59:23] Checking container status...
NAME                    IMAGE                 COMMAND                  SERVICE   CREATED          STATUS                  PORTS
ccontext-github-app-1   ccontext-github-app   "docker-entrypoint.s…"   app       19 seconds ago   Up Less than a second   0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
[2024-09-22 21:59:23] Running containers:
  ccontext-github-app-1
[2024-09-22 21:59:23] Warning: db is not running
[2024-09-22 21:59:23] Warning: redis is not running
[2024-09-22 21:59:23] Checking application logs for startup errors...
[2024-09-22 21:59:23] Deployment completed successfully!
